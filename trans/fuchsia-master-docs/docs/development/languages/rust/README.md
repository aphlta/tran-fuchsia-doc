 
# Rust  锈 

[TOC]  [目录]

 
## Build  建立 

There are two GN target templates which should be used for Rust projects:  Rust项目应使用两个GN目标模板：

 
- [`rustc_library`][target-library-rustc] defines a library which can be used by other targets. -[`rustc_library`] [target-library-rustc]定义了可供其他目标使用的库。
- [`rustc_binary`][target-binary-rustc] defines an executable.  -[`rustc_binary`] [target-binary-rustc]定义了一个可执行文件。

The [garnet/examples/rust][rust-examples] directory has some examples of Rust packages that use these targets, as do the [Rust FIDL examples][fidl-tutorial]. [garnet / examples / rust] [rust-examples]目录包含一些使用这些目标的Rust软件包示例，[Rust FIDL示例] [fidl-tutorial]也是如此。

 
### Building with a custom toolchain  使用自定义工具链进行构建 

If you want to test out Fuchsia with your own custom-built versions of rustc or cargo, you can set the `rustc_prefix` argument to `fx set`, like this: 如果您想使用自己的定制版本的rustc或cargo来测试Fuchsia，则可以将“ rustc_prefix”参数设置为“ fx set”，如下所示：

```
fx set core.x64 --release --args "rustc_prefix=\"/path/to/bin/dir\""
```
 

 
## Cargo.toml  货物清单 

Fuchsia Rust targets are not built with Cargo during a normal build, and as such, do not require `Cargo.toml` files. However, having a `Cargo.toml` file foryour target is useful for integration with IDEs such as Intellij and VSCode, andfor using the [`fargo`][fargo] tool to build and test targets without goingthrough a full GN build and run cycle each time. 在正常构建过程中，紫红色的Rust目标不是由Cargo构建的，因此不需要`Cargo.toml`文件。但是，为目标设置`Cargo.toml`文件对于与Intellij和VSCode之类的IDE集成，以及在不经历完整的GN构建和运行周期的情况下使用[`fargo`] [fargo]工具来构建和测试目标很有用。每一次。

A `Cargo.toml` file can be automatically generated for `rustc_library` and `rustc_binary` targets based on their .gn file definitions by running: 通过运行以下命令，可基于.gn文件定义自动为`rustc_library`和`rustc_binary`目标生成`Cargo.toml`文件：

```sh
fx build path/from/fuchsia_/root/to/target:label_cargo
fx gen-cargo path/from/fuchsia/root/to/target:label
```
 

Note that the label you use must be the GN label for a `rustc_...` GN template invocation, not a Fuchsia package or other GN rule. 请注意，您使用的标签必须是用于“ rustc _...” GN模板调用的GN标签，而不是Fuchsia包或其他GN规则。

Or, if you're already in a directory with a single Rust target:  或者，如果您已经在具有单个Rust目标的目录中：

```sh
fx gen-cargo .
```
 

Note: You must build the target via a regular Fuchsia build before running this command. 注意：在运行此命令之前，您必须通过常规的紫红色构建来构建目标。

 
## Autogenerated docs  自动生成的文档 

You can generate and browse HTML documentation for your target and its dependencies by running: 您可以通过运行以下命令来生成和浏览目标及其依赖关系的HTML文档：

```sh
fx rustdoc path/from/fuchsia/root/to/target:label --open
```
 

 
## Tests  测验 

You can run unit tests on connected devices using `fx`, with the `fx run-test {package name}` command.  See [Testing Rust code](testing.md) for informationon adding and running tests. 您可以使用`fx run-test {package name}`命令，使用`fx`在连接的设备上运行单元测试。有关添加和运行测试的信息，请参见[Testing Rust code]（testing.md）。

 
## Warnings & Errors  警告错误 

By default our build configuration makes all Rust warnings into errors. This requirement can be onerous during development, and on your local machine you may wish to see warnings as warnings andlet CQ enforce the hard boundary. 默认情况下，我们的构建配置会将所有Rust警告变成错误。在开发过程中，此要求可能会很繁重，并且在您的本地计算机上，您可能希望看到警告，因为警告和让CQ强制使用硬边界。

The `rust_cap_lints` GN arg allows you to control this behavior in your development environment. Setting `rust_cap_lints = "warn"` in `fx args` or `fx set` will allow you to develop locally withoutbeing blocked by warnings. rust_cap_lints GN arg允许您在开发环境中控制此行为。在`fx args`或`fx set`中设置`rust_cap_lints =“ warn”`将使您在本地开发，而不会受到警告的阻止。

 
## Style  样式 

We don't currently have a style guide for Rust, but you should run `fx rustfmt` or `fx format-code` before submitting. We mostly use the rustfmt defaults, buthave a couple [custom settings][rustfmt-toml]. 我们目前没有Rust的样式指南，但是您应该在提交前运行`fx rustfmt`或`fx format-code`。我们主要使用rustfmt的默认值，但有几个[自定义设置] [rustfmt-toml]。

 
## Rust Idiomatic Usage Review  Rust惯用用法评论 

If you're new to Rust, and would like someone to review your changes to validate that your usage of Rust is idiomatic, contact one of the following(or add them as a reviewer to your change.) 如果您不熟悉Rust，并且希望有人查看您的更改以确认您对Rust的使用是惯用的，请联系以下人员之一（或将其添加为更改的审阅者。）

 
- adamperry@google.com  -adamperry@google.com
- belgum@google.com  -belgum@google.com
- bwb@google.com  -bwb@google.com
- cramertj@google.com  -cramertj@google.com
- nickpollard@google.com  -nickpollard@google.com
- turnage@google.com  -turnage@google.com

(To volunteer for this, please add yourself to the list above and upload the change with one of the above as the reviewer). （为此，请自愿加入到上面的列表中，并以上述内容之一作为评论者上传更改）。

 
## Communication channels  沟通渠道 

Public discussion happens on the [rust@fuchsia.com] mailing list. For Googler-only channels, see [go/fuchsia-rust-googlers]. 公开讨论在[rust@fuchsia.com]邮件列表中进行。有关仅限Googlers的频道，请参见[go / fuchsia-rust-googlers]。

 
## Existing Fuchsia Rust libraries  现有的樱红色Rust库 

 
- [List of crates](crates.md)  -[板条箱清单]（crates.md）
- [Autogenerated documentation for crates](https://fuchsia-docs.firebaseapp.com)  -[自动生成的板条箱文档]（https://fuchsia-docs.firebaseapp.com）

 
## Going further  更进一步 

 
- [Editor setup](editors.md)  -[编辑器设置]（editors.md）
- [Measuring binary bloat](bloat.md)  -[测量二进制膨胀]（bloat.md）
- [Managing third-party dependencies](third_party.md)  -[管理第三方依赖项]（third_party.md）
- [Unsafe code](unsafe.md)  -[不安全代码]（unsafe.md）
- [Unstable features](unstable.md)  -[不稳定功能]（unstable.md）
- [Rust FIDL server/client tutorial][fidl-tutorial]  -[Rust FIDL服务器/客户端教程] [fidl-tutorial]
- [Syslog API](syslog.md)  -[Syslog API]（syslog.md）
- [Add logging to hello world](add-logging.md)  -[向日志世界添加日志记录]（add-logging.md）

 

